<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IMPOSTOR - Minecraft Edition</title>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --mc-green: #3b8526;
            --mc-dark-green: #2a631c;
            --mc-brown: #8b4513;
            --mc-gray: #7a7a7a;
            --mc-light-gray: #c6c6c6;
            --mc-black: #1e1e1e;
            --mc-yellow: #ffd700;
            --mc-red: #c72a2a;
            --mc-blue: #3a6ea5;
            --mc-purple: #9b30ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--mc-black);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Bot√≥n de configuraci√≥n */
        .config-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background-color: var(--mc-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            border: 3px solid var(--mc-dark-green);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
        }

        .config-btn:hover {
            transform: rotate(30deg);
        }

        .config-btn i {
            font-size: 1.5rem;
            color: white;
        }

        /* Men√∫ de configuraci√≥n */
        .config-menu {
            position: fixed;
            top: 80px;
            right: 20px;
            background-color: rgba(30, 30, 30, 0.95);
            border: 4px solid var(--mc-brown);
            border-radius: 15px;
            padding: 25px;
            width: 350px;
            max-width: 90vw;
            z-index: 999;
            display: none;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .config-menu.active {
            display: block;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .config-title {
            font-family: 'Press Start 2P', cursive;
            color: var(--mc-yellow);
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .config-section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--mc-gray);
        }

        .config-label {
            display: block;
            color: var(--mc-green);
            margin-bottom: 10px;
            font-weight: bold;
            font-size: 1rem;
        }

        .config-input {
            width: 100%;
            padding: 12px;
            background-color: #111;
            border: 2px solid var(--mc-gray);
            border-radius: 8px;
            color: white;
            font-size: 1rem;
        }

        .config-input:focus {
            outline: none;
            border-color: var(--mc-green);
        }

        .time-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .time-option {
            padding: 10px;
            text-align: center;
            background-color: #222;
            border: 2px solid var(--mc-gray);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .time-option:hover {
            background-color: #333;
        }

        .time-option.selected {
            background-color: var(--mc-green);
            border-color: var(--mc-yellow);
            color: white;
        }

        /* Pantallas principales */
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
            background-color: var(--mc-black);
            z-index: 10;
        }

        .screen.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateX(-20px);
        }

        .screen.active {
            opacity: 1;
            pointer-events: all;
            transform: translateX(0);
        }

        .container {
            max-width: 1000px;
            width: 100%;
            padding: 20px;
        }

        /* Pantalla 1: Categor√≠as */
        #screen1 {
            background: linear-gradient(135deg, rgba(30, 30, 30, 1) 0%, rgba(139, 69, 19, 0.8) 100%);
        }

        .title {
            font-family: 'Press Start 2P', cursive;
            color: var(--mc-yellow);
            text-align: center;
            font-size: 3.5rem;
            margin-bottom: 10px;
            text-shadow: 4px 4px 0 var(--mc-dark-green);
            line-height: 1.2;
        }

        .subtitle {
            font-family: 'Press Start 2P', cursive;
            color: var(--mc-green);
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 40px;
            text-shadow: 2px 2px 0 #000;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .category-card {
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 4px solid var(--mc-gray);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        .category-card.selected {
            border-color: var(--mc-green);
            box-shadow: 0 0 20px rgba(59, 133, 38, 0.5);
            transform: translateY(-5px);
        }

        .category-card:hover {
            transform: translateY(-5px);
        }

        .category-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .category-name {
            font-family: 'Press Start 2P', cursive;
            color: white;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .category-check {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: var(--mc-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .category-card.selected .category-check {
            background-color: var(--mc-green);
        }

        /* Bot√≥n principal */
        .main-btn {
            display: block;
            width: 100%;
            max-width: 400px;
            padding: 20px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            background-color: var(--mc-green);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            text-decoration: none;
            border-bottom: 6px solid var(--mc-dark-green);
            margin: 0 auto;
        }

        .main-btn:hover {
            background-color: var(--mc-dark-green);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .main-btn:disabled {
            background-color: var(--mc-gray);
            border-color: #666;
            cursor: not-allowed;
            transform: none;
        }

        /* Timer flotante */
        .floating-timer {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Press Start 2P', cursive;
            font-size: 2rem;
            color: var(--mc-yellow);
            background-color: rgba(0, 0, 0, 0.9);
            padding: 15px 30px;
            border-radius: 10px;
            border: 4px solid var(--mc-green);
            z-index: 100;
            text-shadow: 2px 2px 0 #000;
            display: none;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
        }

        .floating-timer.warning {
            color: var(--mc-red);
            border-color: var(--mc-red);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }

            100% {
                opacity: 1;
            }
        }

        /* Estado del juego */
        .game-status {
            position: fixed;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            padding: 15px 30px;
            border-radius: 10px;
            border: 3px solid var(--mc-green);
            font-family: 'Press Start 2P', cursive;
            font-size: 1rem;
            text-align: center;
            z-index: 99;
            display: none;
        }

        .game-status.active {
            display: block;
            animation: slideDown 0.5s;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        /* Bot√≥n de votaci√≥n flotante */
        .floating-vote-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--mc-red);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 15px 30px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            display: none;
            transition: all 0.3s;
        }

        .floating-vote-btn:hover {
            background-color: #a32222;
            transform: translateY(-3px);
        }

        /* Pantalla 2: Asignaci√≥n de jugadores */
        #screen2 {
            background: linear-gradient(135deg, rgba(30, 30, 30, 1) 0%, rgba(58, 110, 165, 0.8) 100%);
        }

        .player-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        .player-name-display {
            font-family: 'Press Start 2P', cursive;
            font-size: 2.5rem;
            color: var(--mc-yellow);
            margin-bottom: 40px;
            text-shadow: 3px 3px 0 #000;
        }

        .tap-instruction {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            color: var(--mc-light-gray);
            margin-bottom: 40px;
            animation: pulse 2s infinite;
        }

        .tap-area {
            width: 200px;
            height: 200px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 5px dashed var(--mc-gray);
            margin-bottom: 40px;
            cursor: pointer;
        }

        .tap-area i {
            font-size: 4rem;
            color: var(--mc-gray);
        }

        /* Estado revelado */
        .revealed-content {
            display: none;
        }

        .revealed-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .word-display {
            font-family: 'Press Start 2P', cursive;
            font-size: 3.5rem;
            color: var(--mc-yellow);
            margin-bottom: 30px;
            text-shadow: 4px 4px 0 #000;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .spy-display {
            font-family: 'Press Start 2P', cursive;
            font-size: 3rem;
            color: var(--mc-red);
            margin-bottom: 30px;
            text-shadow: 4px 4px 0 #000;
        }

        .category-indicator {
            display: inline-block;
            background-color: var(--mc-purple);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            margin-bottom: 30px;
        }

        /* Modal de votaci√≥n */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background-color: rgba(30, 30, 30, 0.95);
            border: 4px solid var(--mc-blue);
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-title {
            font-family: 'Press Start 2P', cursive;
            color: var(--mc-yellow);
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .vote-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .vote-option {
            padding: 15px;
            background-color: #222;
            border: 2px solid var(--mc-gray);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
        }

        .vote-option:hover {
            background-color: #333;
            transform: translateY(-3px);
        }

        .vote-option.selected {
            background-color: var(--mc-yellow);
            border-color: var(--mc-yellow);
            color: var(--mc-black);
        }

        .results {
            margin-top: 30px;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            border: 3px solid var(--mc-purple);
            display: none;
        }

        .results.active {
            display: block;
        }

        .winner {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.8rem;
            color: var(--mc-yellow);
            margin-bottom: 20px;
            text-align: center;
        }

        /* Barra de progreso */
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background-color: var(--mc-green);
            width: 0%;
            transition: width 0.5s;
        }

        .progress-text {
            text-align: center;
            font-family: 'Press Start 2P', cursive;
            color: var(--mc-light-gray);
            font-size: 0.8rem;
            margin-bottom: 20px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .title {
                font-size: 2.5rem;
            }

            .subtitle {
                font-size: 1.2rem;
            }

            .categories-grid {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }

            .config-menu {
                width: 90vw;
                right: 5vw;
            }

            .floating-timer {
                font-size: 1.5rem;
                padding: 10px 20px;
                top: 15px;
            }

            .player-name-display {
                font-size: 2rem;
            }

            .word-display {
                font-size: 2.5rem;
            }

            .spy-display {
                font-size: 2rem;
            }

            .floating-vote-btn {
                bottom: 20px;
                right: 20px;
                padding: 12px 24px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .title {
                font-size: 1.8rem;
            }

            .categories-grid {
                grid-template-columns: 1fr;
            }

            .word-display {
                font-size: 2rem;
            }

            .floating-timer {
                font-size: 1.2rem;
                padding: 8px 16px;
            }

            .vote-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Bot√≥n de configuraci√≥n -->
    <div class="config-btn" id="config-btn">
        <i class="fas fa-cog"></i>
    </div>

    <!-- Men√∫ de configuraci√≥n -->
    <div class="config-menu" id="config-menu">
        <h3 class="config-title">‚öôÔ∏è CONFIGURACI√ìN</h3>

        <div class="config-section">
            <label class="config-label">JUGADORES (Separados por comas)</label>
            <input type="text" id="players-input" class="config-input" placeholder="Ej: Juan, Ana, Pedro">
            <div style="color: #888; font-size: 0.8rem; margin-top: 5px;">M√≠nimo: 3 jugadores</div>
        </div>

        <div class="config-section">
            <label class="config-label">TIEMPO DE JUEGO</label>
            <div class="time-options">
                <div class="time-option" data-time="60">1 min</div>
                <div class="time-option selected" data-time="180">3 min</div>
                <div class="time-option" data-time="300">5 min</div>
            </div>
        </div>

        <div class="config-section">
            <label class="config-label">CATEGOR√çAS ACTIVAS</label>
            <div style="color: #888; font-size: 0.9rem;">Se configuran en pantalla principal</div>
        </div>

        <button id="save-config" class="main-btn" style="margin-top: 20px; padding: 12px; font-size: 1rem;">
            GUARDAR CONFIGURACI√ìN
        </button>
    </div>

    <!-- Timer flotante -->
    <div class="floating-timer" id="floating-timer">
        05:00
    </div>

    <!-- Estado del juego -->
    <div class="game-status" id="game-status">
        üéÆ JUEGO EN CURSO - Toca para revelar informaci√≥n
    </div>

    <!-- Bot√≥n de votaci√≥n flotante -->
    <button class="floating-vote-btn" id="floating-vote-btn">
        üó≥Ô∏è VOTAR
    </button>

    <!-- Modal de votaci√≥n -->
    <div class="modal-overlay" id="voting-modal">
        <div class="modal-content">
            <h2 class="modal-title">VOTACI√ìN: ¬øQUI√âN ES EL ESP√çA?</h2>

            <div class="vote-options" id="vote-options">
                <!-- Las opciones de votaci√≥n se generar√°n aqu√≠ -->
            </div>

            <button id="submit-vote-btn" class="main-btn" style="margin-top: 20px;">
                ‚úÖ ENVIAR VOTO
            </button>

            <div class="results" id="results">
                <!-- Los resultados se mostrar√°n aqu√≠ -->
            </div>

            <button id="new-game-btn" class="main-btn" style="margin-top: 20px; display: none;">
                üéÆ NUEVA PARTIDA
            </button>

            <button id="close-modal-btn" class="main-btn"
                style="margin-top: 10px; background-color: var(--mc-gray); border-color: #666;">
                CERRAR
            </button>
        </div>
    </div>

    <!-- Pantalla 1: Categor√≠as -->
    <div id="screen1" class="screen active">
        <div class="container">
            <h1 class="title">IMPOSTOR</h1>
            <h2 class="subtitle">Minecraft Edition</h2>

            <p style="text-align: center; margin-bottom: 30px; color: var(--mc-light-gray); font-size: 1.1rem;">
                Selecciona las categor√≠as para esta partida
            </p>

            <div class="categories-grid" id="categories-container">
                <!-- Las categor√≠as se generar√°n aqu√≠ con JavaScript -->
            </div>

            <button id="start-round-btn" class="main-btn">SIGUIENTE RONDA</button>

            <div style="margin-top: 30px; text-align: center; color: var(--mc-light-gray); font-size: 0.9rem;">
                <p>üëÜ Usa el engranaje arriba a la derecha para configurar jugadores y tiempo</p>
                <p>üéÆ Selecciona al menos una categor√≠a para jugar</p>
            </div>
        </div>
    </div>

    <!-- Pantalla 2: Asignaci√≥n de jugadores -->
    <div id="screen2" class="screen hidden">
        <div class="container">
            <div class="progress-bar">
                <div class="progress" id="player-progress"></div>
            </div>
            <div class="progress-text" id="progress-text">Jugador 1 de 5</div>

            <div class="player-screen">
                <div class="player-name-display" id="current-player-name">JUAN</div>

                <!-- Estado 1: Antes de revelar -->
                <div id="state1">
                    <div class="tap-instruction">TOCA LA PANTALLA</div>
                    <div class="tap-area" id="tap-area">
                        <i class="fas fa-hand-pointer"></i>
                    </div>
                    <div style="color: var(--mc-light-gray); font-size: 0.9rem;">
                        Toca para revelar tu informaci√≥n
                    </div>
                </div>

                <!-- Estado 2: Revelado -->
                <div class="revealed-content" id="state2">
                    <div class="category-indicator" id="category-indicator">BIOMAS</div>

                    <div id="normal-player-content">
                        <div class="word-display" id="secret-word">PLAYA</div>
                        <div style="color: var(--mc-light-gray); margin-bottom: 30px; font-size: 1.1rem;">
                            Esta es tu palabra secreta
                        </div>
                    </div>

                    <div id="spy-player-content" style="display: none;">
                        <div class="spy-display">üïµÔ∏è ERES EL ESP√çA</div>
                        <div
                            style="color: var(--mc-light-gray); margin-bottom: 30px; font-size: 1.1rem; max-width: 500px;">
                            No conoces la palabra secreta. Intenta adivinarla o pasa desapercibido.
                        </div>
                    </div>

                    <button id="next-player-btn" class="main-btn">SIGUIENTE JUGADOR</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== DATOS DEL JUEGO ==========
        const gameData = {
            players: ["Juan", "Ana", "Pedro", "Luis", "Mar√≠a"],
            categories: [
                {
                    id: 'biomes',
                    name: 'Biomas üå¥',
                    icon: 'üå¥',
                    selected: true,
                    words: [
                        'Bosque', 'Desierto', 'Llanura', 'Jungla', 'Taiga',
                        'Tundra', 'Pantano', 'Monta√±a', 'Oc√©ano', 'R√≠o',
                        'Playa', 'Isla de setas', 'Bosque oscuro', 'Sabana', 'Llanura de hielo'
                    ]
                },
                {
                    id: 'structures',
                    name: 'Estructuras üè∞',
                    icon: 'üè∞',
                    selected: true,
                    words: [
                        'Aldea', 'Templo del desierto', 'Templo de la jungla', 'Fortaleza del Nether',
                        'Mansi√≥n del bosque', 'Monumento oce√°nico', 'Ciudad del End', 'Mina abandonada',
                        'Pir√°mide', 'Ruinas oce√°nicas', 'Buque hundido', 'Puesto de pillos'
                    ]
                },
                {
                    id: 'items',
                    name: 'Items ‚öîÔ∏è',
                    icon: '‚öîÔ∏è',
                    selected: true,
                    words: [
                        'Pico de diamante', 'Espada de hierro', 'Manzana dorada', 'Br√∫jula', 'Mapa',
                        'Enderperla', 'Ojo de ender', 'Bloque de diamante', 'Mesa de crafteo', 'Horno'
                    ]
                },
                {
                    id: 'mobs',
                    name: 'Mobs üëæ',
                    icon: 'üëæ',
                    selected: true,
                    words: [
                        'Creeper', 'Zombie', 'Esqueleto', 'Ara√±a', 'Enderman',
                        'Slime', 'Ghast', 'Cerdito', 'Vaca', 'Oveja',
                        'Granjero', 'Bruja', 'Drag√≥n del End', 'Wither'
                    ]
                }
            ],
            spyIndex: -1,
            secretWord: '',
            currentPlayerIndex: 0,
            selectedCategory: null,
            gameTime: 180, // 3 minutos por defecto (en segundos)
            timerInterval: null,
            timeLeft: 0,
            votes: {},
            gameState: 'setup' // setup, assigning, playing, voting, ended
        };

        // ========== VARIABLES DE ESTADO ==========
        let revealedThisPlayer = false;

        // ========== ELEMENTOS DOM ==========
        const configBtn = document.getElementById('config-btn');
        const configMenu = document.getElementById('config-menu');
        const playersInput = document.getElementById('players-input');
        const timeOptions = document.querySelectorAll('.time-option');
        const saveConfigBtn = document.getElementById('save-config');

        const screen1 = document.getElementById('screen1');
        const screen2 = document.getElementById('screen2');

        const categoriesContainer = document.getElementById('categories-container');
        const startRoundBtn = document.getElementById('start-round-btn');
        const tapArea = document.getElementById('tap-area');
        const nextPlayerBtn = document.getElementById('next-player-btn');

        const floatingTimer = document.getElementById('floating-timer');
        const gameStatus = document.getElementById('game-status');
        const floatingVoteBtn = document.getElementById('floating-vote-btn');
        const votingModal = document.getElementById('voting-modal');
        const voteOptions = document.getElementById('vote-options');
        const submitVoteBtn = document.getElementById('submit-vote-btn');
        const results = document.getElementById('results');
        const newGameBtn = document.getElementById('new-game-btn');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const playerProgress = document.getElementById('player-progress');
        const progressText = document.getElementById('progress-text');

        // ========== FUNCIONES AUXILIARES ==========
        function showScreen(screenId) {
            // Oculta todas las pantallas
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
                screen.classList.add('hidden');
            });

            // Muestra la pantalla solicitada
            const targetScreen = document.getElementById(screenId);
            targetScreen.classList.remove('hidden');
            setTimeout(() => {
                targetScreen.classList.add('active');
            }, 10);
        }

        function updateStartButtonState() {
            const hasSelected = gameData.categories.some(cat => cat.selected);
            startRoundBtn.disabled = !hasSelected;
        }

        // ========== CONFIGURACI√ìN ==========
        configBtn.addEventListener('click', () => {
            configMenu.classList.toggle('active');
        });

        // Cerrar men√∫ de configuraci√≥n al hacer clic fuera
        document.addEventListener('click', (e) => {
            if (!configMenu.contains(e.target) && !configBtn.contains(e.target)) {
                configMenu.classList.remove('active');
            }
        });

        // Seleccionar tiempo
        timeOptions.forEach(option => {
            option.addEventListener('click', () => {
                timeOptions.forEach(opt => opt.classList.remove('selected'));
                option.classList.add('selected');
                gameData.gameTime = parseInt(option.dataset.time);
            });
        });

        // Guardar configuraci√≥n
        saveConfigBtn.addEventListener('click', () => {
            const playersText = playersInput.value.trim();

            if (!playersText) {
                alert('Por favor, ingresa los nombres de los jugadores.');
                return;
            }

            // Parsear jugadores
            gameData.players = playersText.split(',')
                .map(name => name.trim())
                .filter(name => name.length > 0);

            if (gameData.players.length < 3) {
                alert('Se necesitan al menos 3 jugadores para jugar.');
                return;
            }

            if (gameData.players.length > 10) {
                alert('M√°ximo 10 jugadores permitidos.');
                return;
            }

            // Cerrar men√∫ de configuraci√≥n
            configMenu.classList.remove('active');

            // Actualizar informaci√≥n visual
            initCategories();
            updateStartButtonState();

            alert('Configuraci√≥n guardada correctamente.');
        });

        // ========== CATEGOR√çAS ==========
        function initCategories() {
            categoriesContainer.innerHTML = '';

            gameData.categories.forEach(category => {
                const card = document.createElement('div');
                card.className = `category-card ${category.selected ? 'selected' : ''}`;
                card.dataset.id = category.id;

                card.innerHTML = `
                    <div class="category-icon">${category.icon}</div>
                    <div class="category-name">${category.name}</div>
                    <div class="category-check">${category.selected ? '‚úî' : ''}</div>
                `;

                card.addEventListener('click', () => {
                    category.selected = !category.selected;
                    card.classList.toggle('selected');
                    card.querySelector('.category-check').textContent = category.selected ? '‚úî' : '';
                    updateStartButtonState();
                });

                categoriesContainer.appendChild(card);
            });
        }

        // ========== INICIAR RONDA ==========
        startRoundBtn.addEventListener('click', () => {
            // Verificar que al menos una categor√≠a est√© seleccionada
            const selectedCategories = gameData.categories.filter(cat => cat.selected);

            if (selectedCategories.length === 0) {
                alert('Selecciona al menos una categor√≠a.');
                return;
            }

            // 3Ô∏è‚É£ SELECCI√ìN INTERNA (NO visible)
            // Elegir categor√≠a aleatoria de las seleccionadas
            const randomCatIndex = Math.floor(Math.random() * selectedCategories.length);
            gameData.selectedCategory = selectedCategories[randomCatIndex];

            // Elegir palabra secreta aleatoria de esa categor√≠a
            const wordIndex = Math.floor(Math.random() * gameData.selectedCategory.words.length);
            gameData.secretWord = gameData.selectedCategory.words[wordIndex];

            // Elegir esp√≠a aleatorio
            gameData.spyIndex = Math.floor(Math.random() * gameData.players.length);

            // Reiniciar √≠ndice de jugador actual
            gameData.currentPlayerIndex = 0;
            gameData.votes = {};
            revealedThisPlayer = false;

            // Ir a pantalla de asignaci√≥n de jugadores
            showScreen('screen2');
            showPlayer();
        });

        // ========== ASIGNACI√ìN DE JUGADORES ==========
        function showPlayer() {
            const playerName = gameData.players[gameData.currentPlayerIndex];
            document.getElementById('current-player-name').textContent = playerName.toUpperCase();

            // Restablecer estado
            document.getElementById('state1').style.display = 'block';
            document.getElementById('state2').classList.remove('active');
            document.getElementById('state2').style.display = 'none';

            // Resetear variable de revelaci√≥n
            revealedThisPlayer = false;

            // Actualizar barra de progreso
            const progress = ((gameData.currentPlayerIndex) / gameData.players.length) * 100;
            playerProgress.style.width = `${progress}%`;
            progressText.textContent =
                `Jugador ${gameData.currentPlayerIndex + 1} de ${gameData.players.length}`;
        }

        // Tocar para revelar informaci√≥n
        tapArea.addEventListener('click', () => {
            if (revealedThisPlayer) return;

            revealedThisPlayer = true;

            // Ocultar √°rea de toque
            document.getElementById('state1').style.display = 'none';

            // Mostrar contenido revelado
            const state2 = document.getElementById('state2');
            state2.style.display = 'block';
            setTimeout(() => {
                state2.classList.add('active');
            }, 10);

            // Mostrar categor√≠a
            document.getElementById('category-indicator').textContent =
                gameData.selectedCategory.name.split(' ')[0].toUpperCase();

            // Verificar si es el esp√≠a
            const isSpy = gameData.currentPlayerIndex === gameData.spyIndex;

            if (isSpy) {
                // Mostrar contenido de esp√≠a
                document.getElementById('normal-player-content').style.display = 'none';
                document.getElementById('spy-player-content').style.display = 'block';
            } else {
                // Mostrar contenido de jugador normal
                document.getElementById('normal-player-content').style.display = 'block';
                document.getElementById('spy-player-content').style.display = 'none';
                document.getElementById('secret-word').textContent = gameData.secretWord;
            }
        });

        // Siguiente jugador
        nextPlayerBtn.addEventListener('click', () => {
            gameData.currentPlayerIndex++;

            if (gameData.currentPlayerIndex < gameData.players.length) {
                showPlayer();
            } else {
                // Todos los jugadores han visto su informaci√≥n
                // Volver a pantalla de categor√≠as para empezar el juego
                showScreen('screen1');

                // Mostrar mensaje de juego en curso
                gameStatus.classList.add('active');

                // Mostrar bot√≥n de votaci√≥n
                floatingVoteBtn.style.display = 'block';

                // Iniciar temporizador
                startGameTimer();

                // Mostrar timer flotante
                floatingTimer.style.display = 'block';

                // Cambiar texto del bot√≥n
                startRoundBtn.textContent = 'NUEVA RONDA';

                alert('¬°Todos los jugadores han visto su informaci√≥n!\n\nEl juego comienza ahora. Los jugadores pueden discutir libremente.\n\nEl temporizador ha comenzado. Cuando est√©n listos para votar, presionen el bot√≥n rojo de VOTAR en la esquina inferior derecha.');
            }
        });

        // ========== TEMPORIZADOR ==========
        function startGameTimer() {
            // Limpiar intervalo anterior si existe
            if (gameData.timerInterval) {
                clearInterval(gameData.timerInterval);
            }

            gameData.timeLeft = gameData.gameTime;
            updateTimerDisplay();

            gameData.timerInterval = setInterval(() => {
                gameData.timeLeft--;
                updateTimerDisplay();

                if (gameData.timeLeft <= 30) {
                    floatingTimer.classList.add('warning');
                    gameStatus.innerHTML = '‚è∞ ¬°POCO TIEMPO! - Toca para revelar informaci√≥n';
                }

                if (gameData.timeLeft <= 0) {
                    clearInterval(gameData.timerInterval);
                    endGameTime();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameData.timeLeft / 60);
            const seconds = gameData.timeLeft % 60;
            floatingTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function endGameTime() {
            floatingTimer.classList.add('warning');
            floatingTimer.textContent = '¬°TIEMPO!';
            gameStatus.innerHTML = '‚è∞ ¬°SE ACAB√ì EL TIEMPO! - Es hora de votar';

            // Mostrar alerta
            setTimeout(() => {
                alert('¬°Se acab√≥ el tiempo! Es hora de votar.');
                openVotingModal();
            }, 500);
        }

        // ========== VOTACI√ìN ==========
        function openVotingModal() {
            // Detener temporizador si a√∫n est√° corriendo
            if (gameData.timerInterval) {
                clearInterval(gameData.timerInterval);
            }

            // Mostrar modal
            votingModal.classList.add('active');

            // Generar opciones de votaci√≥n
            generateVoteOptions();
        }

        floatingVoteBtn.addEventListener('click', openVotingModal);

        function generateVoteOptions() {
            voteOptions.innerHTML = '';

            gameData.players.forEach((player, index) => {
                const voteOption = document.createElement('div');
                voteOption.className = 'vote-option';
                voteOption.dataset.playerIndex = index;
                voteOption.textContent = player;

                voteOption.addEventListener('click', () => {
                    // Deseleccionar todas las opciones
                    document.querySelectorAll('.vote-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });

                    // Seleccionar esta opci√≥n
                    voteOption.classList.add('selected');
                });

                voteOptions.appendChild(voteOption);
            });
        }

        // Enviar voto
        submitVoteBtn.addEventListener('click', () => {
            const selectedOption = document.querySelector('.vote-option.selected');

            if (!selectedOption) {
                alert('Por favor, selecciona un jugador antes de votar.');
                return;
            }

            const votedIndex = parseInt(selectedOption.dataset.playerIndex);

            // Registrar voto
            gameData.votes[`vote_${Object.keys(gameData.votes).length}`] = votedIndex;

            // Simular votos de otros jugadores (para demo)
            simulateOtherVotes(votedIndex);
        });

        function simulateOtherVotes(userVote) {
            // Deshabilitar bot√≥n
            submitVoteBtn.disabled = true;
            submitVoteBtn.textContent = 'VOTANDO...';

            setTimeout(() => {
                // Simular votos de otros jugadores
                for (let i = Object.keys(gameData.votes).length; i < gameData.players.length; i++) {
                    let randomVote;

                    // Los jugadores tienen mayor probabilidad de votar al esp√≠a
                    if (Math.random() > 0.4) {
                        randomVote = gameData.spyIndex;
                    } else if (Math.random() > 0.5) {
                        randomVote = userVote;
                    } else {
                        randomVote = Math.floor(Math.random() * gameData.players.length);
                    }

                    gameData.votes[`vote_${i}`] = randomVote;
                }

                // Mostrar resultados
                showVotingResults();

            }, 1500);
        }

        function showVotingResults() {
            // Calcular votos
            const voteCounts = {};
            gameData.players.forEach((_, index) => {
                voteCounts[index] = 0;
            });

            Object.values(gameData.votes).forEach(playerIndex => {
                voteCounts[playerIndex]++;
            });

            // Encontrar el m√°s votado
            let maxVotes = 0;
            let mostVotedIndex = -1;

            for (const [playerIndex, count] of Object.entries(voteCounts)) {
                if (count > maxVotes) {
                    maxVotes = count;
                    mostVotedIndex = parseInt(playerIndex);
                }
            }

            // Determinar si hay empate
            const tiedPlayers = Object.entries(voteCounts)
                .filter(([_, count]) => count === maxVotes)
                .map(([playerIndex, _]) => parseInt(playerIndex));

            const isTie = tiedPlayers.length > 1;

            // Mostrar resultados
            submitVoteBtn.style.display = 'none';
            results.classList.add('active');

            let resultsHTML = `<div class="winner">¬°VOTACI√ìN TERMINADA!</div>`;

            resultsHTML += `<p style="margin-bottom: 15px;"><strong>Palabra secreta:</strong> ${gameData.secretWord}</p>`;
            resultsHTML += `<p style="margin-bottom: 15px;"><strong>Categor√≠a:</strong> ${gameData.selectedCategory.name}</p>`;

            // Mostrar conteo de votos
            resultsHTML += `<h4 style="color: var(--mc-yellow); margin: 20px 0 10px;">RESULTADOS:</h4>`;

            gameData.players.forEach((player, index) => {
                const voteCount = voteCounts[index];
                resultsHTML += `<p>${player}: ${voteCount} voto${voteCount !== 1 ? 's' : ''} ${index === gameData.spyIndex ? '(ESP√çA)' : ''}</p>`;
            });

            // Mostrar ganador
            if (isTie) {
                resultsHTML += `<div class="winner" style="margin-top: 20px; color: var(--mc-blue);">¬°EMPATE! Nadie es expulsado.</div>`;
                resultsHTML += `<div class="winner" style="color: var(--mc-red);">¬°EL ESP√çA GANA!</div>`;
            } else {
                const mostVotedPlayer = gameData.players[mostVotedIndex];
                resultsHTML += `<div class="winner" style="margin-top: 20px;">${mostVotedPlayer} es expulsado con ${maxVotes} votos.</div>`;

                if (mostVotedIndex === gameData.spyIndex) {
                    resultsHTML += `<div class="winner" style="color: var(--mc-green);">¬°ERA EL ESP√çA! LOS JUGADORES GANAN.</div>`;
                } else {
                    resultsHTML += `<div class="winner" style="color: var(--mc-red);">¬°NO ERA EL ESP√çA! EL ESP√çA GANA.</div>`;
                }
            }

            results.innerHTML = resultsHTML;

            // Mostrar bot√≥n de nueva partida
            newGameBtn.style.display = 'block';
        }

        // ========== NUEVA PARTIDA ==========
        newGameBtn.addEventListener('click', resetGame);

        function resetGame() {
            // Resetear datos del juego
            gameData.spyIndex = -1;
            gameData.secretWord = '';
            gameData.currentPlayerIndex = 0;
            gameData.selectedCategory = null;
            gameData.votes = {};
            gameData.timeLeft = 0;

            // Ocultar elementos flotantes
            floatingTimer.style.display = 'none';
            floatingTimer.classList.remove('warning');
            gameStatus.classList.remove('active');
            floatingVoteBtn.style.display = 'none';

            // Cerrar modal
            votingModal.classList.remove('active');

            // Resetear botones
            submitVoteBtn.disabled = false;
            submitVoteBtn.textContent = '‚úÖ ENVIAR VOTO';
            submitVoteBtn.style.display = 'block';
            newGameBtn.style.display = 'none';
            results.classList.remove('active');
            startRoundBtn.textContent = 'SIGUIENTE RONDA';

            // Resetear progreso
            playerProgress.style.width = '0%';

            // Volver a pantalla de inicio
            showScreen('screen1');
            updateStartButtonState();

            alert('¬°Nueva partida lista! Configura las categor√≠as y presiona "SIGUIENTE RONDA".');
        }

        // Cerrar modal
        closeModalBtn.addEventListener('click', () => {
            votingModal.classList.remove('active');
            submitVoteBtn.disabled = false;
            submitVoteBtn.textContent = '‚úÖ ENVIAR VOTO';
            submitVoteBtn.style.display = 'block';
            results.classList.remove('active');
            newGameBtn.style.display = 'none';
        });

        // ========== INICIALIZACI√ìN ==========
        window.addEventListener('DOMContentLoaded', () => {
            // Cargar jugadores por defecto
            playersInput.value = gameData.players.join(', ');

            // Inicializar categor√≠as
            initCategories();
            updateStartButtonState();

            // Establecer 3 minutos como seleccionado por defecto
            const defaultTimeOption = document.querySelector('.time-option[data-time="180"]');
            if (defaultTimeOption) {
                defaultTimeOption.classList.add('selected');
            }
        });
    </script>
</body>

</html>